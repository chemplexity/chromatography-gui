function [peaks, debug] = peakfindNN(varargin)
% ------------------------------------------------------------------------
% Function    : peakfindNN
% Description : neural network based peak detection
% ------------------------------------------------------------------------
%
% ------------------------------------------------------------------------
% Syntax
% ------------------------------------------------------------------------
%   peaks = peakfindNN(x, y)
%   peaks = peakfindNN( __ , Name, Value)
%
% ------------------------------------------------------------------------
% Input (Required)
% ------------------------------------------------------------------------
%   x -- time values
%       array (size = n x 1)
%
%   y -- intensity values
%       array (size = n x 1)
%
% ------------------------------------------------------------------------
% Input (Name, Value)
% ------------------------------------------------------------------------
%   'xmin' -- sets minimum x-value for peaks
%       empty (default) | number
%
%   'xmax' -- sets maximum x-value for peaks
%       empty (default) | number
%
%   'ymin' -- sets minimum y-value for peaks
%       empty (default) | number
%
%   'ymax' -- sets maximum y-value for peaks
%       empty (default) | number
%
%   'sensitivity' -- increases sensitivity for smaller peaks
%       250 (default) | number (~1 to 10000)

% ---------------------------------------
% Defaults
% ---------------------------------------
default.xmin = [];
default.xmax = [];
default.ymin = [];
default.ymax = [];
default.sensitivity = 250;

% ---------------------------------------
% Variables
% ---------------------------------------
peaks = [];
debug = {};

% ---------------------------------------
% Input
% ---------------------------------------
p = inputParser;

addRequired(p, 'x', @isnumeric);
addRequired(p, 'y', @isnumeric);

addParameter(p, 'xmin', default.xmin);
addParameter(p, 'xmax', default.xmax);
addParameter(p, 'ymin', default.ymin);
addParameter(p, 'ymax', default.ymax);
addParameter(p, 'sensitivity', default.sensitivity);

parse(p, varargin{:});

% ---------------------------------------
% Parse
% ---------------------------------------
x = p.Results.x;
y = p.Results.y;

options.xmin = p.Results.xmin;
options.xmax = p.Results.xmax;
options.ymin = p.Results.ymin;
options.ymax = p.Results.ymax;
options.sensitivity = p.Results.sensitivity;

% ---------------------------------------
% Validate
% ---------------------------------------
if size(x,1) == 1 && size(x,2) ~= 1
    x = x';
end

if size(y,1) == 1 && size(y,2) ~= 1
    y = y';
end

if size(x,1) ~= size(y,1)
    return
end

if ~isempty(options.xmin) && options.xmin > min(x)
    y = y(x >= options.xmin);
    x = x(x >= options.xmin);
end

if isempty(x) || isempty(y)
    return
end

if ~isempty(options.xmax) && options.xmax < max(x)
    y = y(x <= options.xmax);
    x = x(x <= options.xmax);
end

if isempty(x) || isempty(y)
    return
end

if isempty(options.sensitivity)
    options.sensitivity = default.sensitivity;
elseif options.sensitivity <= 1
    options.sensitivity = 1;
end

% ---------------------------------------
% Resample (500 Hz)
% ---------------------------------------
x0 = x;
y0 = y;

[x,y] = resample(x,y);

if isempty(x) || isempty(y)
    return
end

% ---------------------------------------
% Prepare input
% ---------------------------------------
inputSize = 50;

x = x(1:floor(length(x)/inputSize)*inputSize);
y = y(1:floor(length(y)/inputSize)*inputSize);

ymin = min(y);
ymax = max(y);

y = ((y - ymin) ./ (ymax - ymin)) * options.sensitivity;

% ---------------------------------------
% Find peaks
% ---------------------------------------
[peaks, debug{1}] = getpeaks(x, y, peaks, inputSize, 0);
[peaks, debug{2}] = getpeaks(x, y, peaks, inputSize, 10);
[peaks, debug{3}] = getpeaks(x, y, peaks, inputSize, 20);
[peaks, debug{4}] = getpeaks(x, y, peaks, inputSize, 30);
[peaks, debug{5}] = getpeaks(x, y, peaks, inputSize, 40);

% ---------------------------------------
% Prepare output
% ---------------------------------------
if ~isempty(peaks)
    peaks = filterpeaks(x, y, peaks);
end

if ~isempty(peaks)
    peaks = prepareOutput(x0, y0, peaks, ymin, ymax, options);
end

end

function peaks = prepareOutput(x, y, peaks, ymin, ymax, options)

% Rescale intensity back to original
peaks(:,2) = (peaks(:,2) ./ options.sensitivity) .* (ymax-ymin) + ymin;

if ~isempty(peaks) && ~isempty(options.ymin)
    peaks(peaks(:,2) - ymin < options.ymin, :) = [];
end

if ~isempty(peaks) && ~isempty(options.ymax)
    peaks(peaks(:,2) - ymin > options.ymax, :) = [];
end

% Get peak center and peak height
for i = 1:length(peaks(:,1))
    
    xi = find(x >= peaks(i,1), 1);

    % Check previous index
    if xi > 1 && abs(peaks(i,1) - x(xi-1)) < abs(peaks(i,1) - x(xi))
        xi = xi - 1;
    end
    
    if ~isempty(xi)
        
        xpad = 3;
        
        if length(y) >= xi + xpad && xi - xpad >= 1
            [~, idx] = max(y(xi-xpad:xi+xpad));
            xi = xi + (idx-xpad-1);
        end
        
        peaks(i,1) = x(xi);
        peaks(i,2) = y(xi);
        
    end
    
end

% Filter peaks with unique retention times
[~, idx] = unique(peaks(:,1));
peaks = peaks(idx,:);

end

function [peaks, rawdata] = getpeaks(x, y, peaks, inputSize, inputShift)

minOutput = 0.95;

if inputShift == 0
    yInput = reshape(y, inputSize, [])';
    yOffset = 0;
else

    if verLessThan('matlab', 'R2016b')
        yInput = reshape(circshift(y, [0, inputShift]), inputSize, [])';
    else
        yInput = reshape(circshift(y, inputShift, 1), inputSize, [])';
    end

    yInput(1,:) = [];
    yOffset = inputShift - inputSize;
end

rawdata = findPeaksNeuralNetwork(yInput');
yOutput = find(rawdata(:,1) > minOutput);

if ~isempty(yOutput)
    
    [py, xi] = max(yInput(yOutput,:), [], 2);
    px = x((yOutput-1) .* inputSize + xi - yOffset);
    
    if size(px,1) == 1 && size(px,2) ~= 1
        px = px';
    end
    
    if size(py,1) == 1 && size(py,2) ~= 1
        py = py';
    end
    
    peaks = [peaks; px, py];
    
end

end

function peaks = filterpeaks(x, y, peaks)

[~, xi] = sort(peaks(:,1));
peaks = peaks(xi,:);

[~, xi] = unique(peaks(:,1));
peaks = peaks(xi,:);

minWidth = 0.02;

if size(peaks,1) > 1
    
    px = find(diff(peaks(:,1)) <= minWidth);
    
    if ~isempty(px)
        
        dx = arrayfun(@(i) find(x>=i,1), [peaks(px), peaks(px+1)]);
        dy = arrayfun(@(i,j) diff(y(i:j)), dx(:,1), dx(:,2), 'uniformoutput', 0);
        dy = cellfun(@(y) sum(y>0)/length(y), dy);
        
        peakIndex = [-1; px(dy < 0.5)] + 1;
        peakIndex = [peakIndex; px(dy >= 0.5)];
        peakIndex = unique(peakIndex);
        
        peaks(peakIndex(peakIndex>0), :) = [];
        
    end
    
end

idx = [];
xpad = 25;
nmin = 0.8;

if size(peaks,1) > 1
    
    for i = 1:length(peaks(:,1))
        
        xi = find(x >= peaks(i,1), 1);
        
        if isempty(xi)
            continue
        end
        
        if xi <= xpad-1
            continue
        else
            xmin = xi - (xpad-1);
        end
        
        if xi + xpad > length(x)
            continue
        else
            xmax = xi + xpad;
        end
        
        dy = diff(y(xmin:xmax));
        
        if length(dy) < xpad
            continue
        end
        
        n = sum(dy(xpad:end) > 0);
        
        if n >= xpad * nmin
            idx(end+1) = i;
        end
        
        n = sum(dy(1:xpad) < 0);
        
        if n >= xpad * nmin
            idx(end+1) = i;
        end
        
    end
    
    idx = unique(idx);
    
    if ~isempty(idx)
        peaks(idx,:) = [];
    end
    
end

end

function [x0,y0] = resample(x,y,varargin)

minSize = 25;

if ~isempty(varargin) && isnumeric(varargin{1})
    sampleRate = varargin{1};
else
    sampleRate = 500;
end

x0 = [];
y0 = [];

if isempty(x) || isempty(y) || ~any(x) || ~any(y)
    return
elseif length(x) < minSize || length(y) < minSize
    return
end

f0 = 1 / mean(diff(x(1:minSize)));
ftol = 25;

if f0 > sampleRate
    
    dx = round(1./(x(3:20)-x(2)));
    
    if any(dx == sampleRate)
        
        ii = find(dx == sampleRate, 1);
        x0 = x(1:ii:end);
        y0 = y(1:ii:end);
        
    elseif any(dx >= sampleRate-ftol & dx <= sampleRate+ftol)
        
        ii = find(dx >= sampleRate-ftol & dx <= sampleRate+ftol, 1);
        x0 = x(1:ii:end);
        y0 = y(1:ii:end);
        
    else
        x0 = min(x):1/sampleRate:max(x);
        y0 = interp1(x,y,x0);
    end
    
elseif f0 < sampleRate
    x0 = min(x):1/sampleRate:max(x);
    y0 = interp1(x,y,x0);
end

end

function yOutput = findPeaksNeuralNetwork(yInput)

inputSize = 50;

if size(yInput,2) == inputSize && size(yInput,1) ~= inputSize
    yInput = yInput';
    
elseif size(yInput,2) ~= inputSize && size(yInput,1) ~= inputSize
    
    if mod(length(yInput),inputSize) ~= 0
        yInput = yInput(1:floor(length(yInput)/inputSize)*inputSize);
    end
    
    yInput = reshape(yInput, inputSize, []);
    
end

inputStep.xoffset = [5.38593778089853;5.38320340575592;5.3782554888312;5.37656278040959;5.3744794469676;5.36979194672313;5.36653673822002;5.36119819627493;5.35989611287368;5.35950548785331;5.36432319643791;5.36562527983915;5.36835965498176;5.37083361344412;5.3750002803281;5.37408882194723;5.37265653020586;5.37200548850524;5.37239611352561;5.37135444680462;5.36979194672313;5.37213569684536;5.37291694688611;5.37096382178424;5.36471382145828;5.36263048801629;5.36171902963542;5.36510444647865;5.36406277975766;5.3664065298799;5.36354194639716;5.3610679879348;5.35963569619344;5.35807319611195;5.36028673789406;5.36015652955393;5.36406277975766;5.36875028000213;5.37473986364785;5.38072944729356;5.38242215571518;5.38437528081704;5.38385444745654;5.38658882259915;5.38802111434052;5.39218778122449;5.39687528146897;5.39752632316959;5.39257840624487;5.39023465612263];
inputStep.gain    = [0.000201606107727095;0.000196478850642074;0.000190999002414566;0.000185242152496963;0.000179473479221447;0.000174019873783397;0.000168969970216551;0.000164097274977793;0.000159480634662289;0.000154996438602584;0.000150993897712183;0.000147257484037625;0.000143318472397375;0.000139052172893222;0.000134767388263713;0.00013096690336503;0.000127558264369696;0.000124370760226381;0.000121220091004044;0.000118010451846014;0.000114817116796983;0.000111752784892012;0.000108945553938192;0.000106457932583748;0.000104452230299456;0.000103553700939105;0.000105389571500413;0.000111822482839661;0.000123225892615108;0.000136907241184923;0.000148289179621965;0.000155679409647772;0.000160787643424089;0.000165500049632925;0.000170376791943423;0.000176235416921945;0.000183863697320233;0.000194670121878757;0.000209548426513111;0.000227670228770849;0.000245676960162577;0.00025969925098765;0.000268942179072841;0.000274381777699867;0.000277123054061363;0.000277508395061435;0.000276659916336913;0.000275086939815481;0.000273697753219546;0.00027289637963871];
inputStep.ymin    = -1;

outputStep.ymin    = -1;
outputStep.gain    = [2;2];
outputStep.xoffset = [0;0];

b1  = [-14.277302068044982;-1.2566688700581385;-3.5889774767785227;3.8969030881476221;-2.1871741137425711;-73.723061777918389;2.4954127886574113;1.9772236019977774;-2.1684768426027605;-24.049370790768606;70.816937510106243;-19.680723260162281;1.327777819565944;-0.80032824531825397;2.3834179120114141;0.71590556221455259;-4.6029410394297434;-52.563800464369173;66.827455441800367;2.667966217222618;-130.21498624682195;-107.31639902064904;-79.590165221468894;-18.453756863608604;55.002053418773194;61.90877309714979;-5.1532637487839592;-1.4269660282352437;-49.073354299413758;-47.263843460344667;-2.2591573024775427;201.57724262623373;-2.8336428632260553;3.3864704752477923;1.4599668353361148;-44.152428058726315;-3.823057767501493;111.71828147959415;4.7178447759241484;23.301796855616427;-3.6724353581475668;111.45558903343984;-2.2737065631374516;-11.837356490274306;-121.69044618241006;-5.2483020913830174;-2.7915798244961714;4.5239494871321524;0.10496158380659366;-58.821201457967121];
IW1 = [34.788614020990444 35.071524995296116 35.99255416455587 36.447763611419226 36.408756133957802 36.984773493247417 37.193900270120409 37.903289812533636 37.574026329768358 38.197512074199963 38.463964986249287 39.155773542056608 39.410178664759165 39.471038381381788 39.426117146178214 40.046606953169409 40.10330529789816 40.464153598401282 40.175529888144766 40.175865937980532 40.179642319441356 40.466333577462031 40.413750770827065 40.198369059961458 40.103749288561055 39.330262430162897 39.796480568879581 41.158762965848346 43.538005602985464 45.713157488961485 47.367679090373066 47.379420641513647 47.20652732424103 46.22451133051888 45.576647150743128 44.45575451742225 44.102022724655662 43.684443706974321 43.461262127638179 43.419536711669203 43.274021794712453 42.585361022770833 41.435748996162374 40.047726856624962 37.697546336955675 35.499570673894723 34.044772713792767 32.461947564616324 30.606734468319651 29.094143148120263;-0.15413198315546892 -0.36751848280158839 0.16386641553624312 -0.47140231825010581 0.19941867203269492 -0.28018009346789807 0.17044621727105455 -0.26271313510780259 -0.12620119106760444 0.16209652195896379 -0.061683943818391172 -0.30152844592054862 -0.15260284151796202 -0.33236519597063396 0.089384918952207598 0.18470349907345049 -0.28052550195964987 -0.020371028221581839 -0.50412527925647466 -0.41886466025347568 -0.27262990445844876 -0.023149285268197858 -0.0755065030365214 -0.45760043020459085 -0.53909356658783625 -0.28596194637709788 -0.39329463130654285 0.08237986989937518 -0.12015141290609478 0.060036810095564982 -0.18541667356108124 -0.42666274976227625 -0.21920278381390473 -0.24545029693434531 -0.47738346411889387 -0.45246055187367318 -0.30450282321878336 -0.23778585121686444 -0.53373888368474931 -0.27757690898969506 0.14431505437440112 -0.14184464695753407 -0.12014036199241226 -0.32666598830651089 -0.29279983268825255 -0.31737022672638338 -0.40625723735141278 -0.059158903143878512 -0.45702490519378386 -0.34951852495546437;1.752669485603594 1.6452308099646142 1.5394698609870114 1.8013616490670343 1.4344274308828964 1.6737281782435696 1.5830243554225256 1.732409149072204 1.6693221746364977 1.3314480973931586 1.169831659395582 1.548017322388638 1.4345252099896306 1.3220270087333486 1.5792987106806375 1.3124109238496833 1.7585768293057478 1.7454005536912622 1.6348011290390907 1.2472817597778043 1.4657587638780989 1.681346345235182 1.6909132729441778 1.0882717240528026 1.5029803686329106 1.1442889749997915 1.2523029481435903 1.1952772220741386 1.652667418436117 1.4553674143623061 0.9270454968165277 1.4488262201395692 0.94175166801364951 1.0549915379554822 1.4609064797506681 1.0316621999586382 1.4711682135444502 1.254278195352593 1.5042367536658656 1.1930459455322708 1.460431342970677 1.1202842598078475 1.6319111289613246 1.7456128482772824 1.3836050294699036 1.8506431570321977 1.3088864649374405 1.8815449678937295 1.4167284070160728 1.9049175642578731;-2.1574346666175188 -1.6801037053360048 -2.1673192316540235 -2.1505721491382022 -2.1531782844619993 -2.1460846033411567 -1.8012742593087616 -1.4369435826613746 -1.8291019336180543 -2.025147975740226 -1.6541345381492438 -1.6077777938761242 -1.7372107379953419 -2.1042330933124767 -1.418519681562169 -1.6419967379823532 -2.1134921713395953 -1.5567267984887392 -1.5807922277016284 -1.6128559086808405 -1.8667983603500933 -1.920174417397702 -1.6183160577596352 -1.9779679799954568 -1.6840738141791505 -2.086148753211067 -1.7154184587847894 -1.6621554819884516 -1.7424865737734534 -1.768202919630675 -1.6659261134351642 -1.3788420596932014 -1.6131742815693961 -1.3535345650846888 -1.6330783260418587 -1.6293285090311871 -2.0269667263910898 -1.8968786611272139 -1.4314850703922068 -1.4919705552876452 -1.5115357324843273 -1.8516785992399543 -1.9734988392028521 -1.6351967742359825 -1.8790160034348686 -1.7059100343079785 -1.7482890198262855 -1.8606745464835894 -1.7217048902093921 -2.0246603454062075;0.94079782511628696 0.26170548180783393 0.26320453859100923 0.65194214161229536 0.40087541202532306 0.52911189923366642 0.55201098307589624 0.79115826213486362 0.73595017999380974 0.73133771571180917 0.61865701060177691 0.84562489872384128 0.64835409693518764 0.46000083274581627 0.86202227337819137 0.69895674150833476 0.55576512378173526 0.19805491661451874 0.82969843709946356 0.13778748873049132 0.38137980882074929 0.23562267666830983 0.659011760691815 0.6325938969686602 0.69653824848663293 0.50665115208374822 0.73763858969830154 0.60654499325848599 0.74728537139666162 0.74227904695379499 0.11129880180272622 0.17849882262313244 0.40076207455828095 0.8016604482771732 0.63174600417145466 0.30193039100327995 0.37821539164126355 0.47740643353890477 0.32591954215651092 0.56536866910158667 0.61638424669762637 0.58317543157806095 0.27741565423531478 0.31021341966395727 0.26902432731895759 0.5704511668588802 0.75357428056325981 0.63227372938535098 1.0108898107857947 0.44207236698782892;12.623865952134576 10.927115235831751 9.6466898210181498 9.0004955032760279 8.2752877556759117 6.7446534373886688 5.8677457647460258 4.4626089433376483 3.7097645969251869 2.3106068844811505 1.3609654000077571 0.25959768712244269 -0.91702267601677945 -1.2297930955684411 -2.2551557739701051 -2.3842624956791232 -3.091430829218448 -4.1102220225139057 -4.2528320015507344 -4.2083747059289687 -4.1008434239263583 -3.7834377200279379 -3.0952102799248857 -2.55819677849097 -2.0406516666072454 -1.8949727414833759 -2.3909619488909701 -6.7625972875586537 -13.447054208267017 -20.458512199631834 -24.820719462790681 -25.067899794365974 -24.254589045670414 -21.723501673509951 -18.759894728953981 -16.052773573099103 -13.806086828904519 -12.453670867079275 -12.768713846442903 -12.878239252551472 -12.720242231960217 -10.602074838246116 -6.2808922338307882 -0.89559131898546407 5.1946401132412694 11.09387671662402 16.406295474377476 21.776227103078355 26.648006579603368 31.249036064531712;0.034957696363185194 0.072586935350839127 0.19549636573913426 0.26367447739020072 -0.028644536124398913 -0.056340813254908986 0.35588292107545638 -0.076457936336469162 0.47294223734239299 0.075214347394868403 0.27081336487241114 0.27923368598306791 0.71894613464485735 0.4411980411330495 0.23101320471372061 0.40029126521104702 0.26641310959362019 0.86528655494281315 0.62270165343733619 0.47259593860809063 0.51998789229404674 0.59316656132541223 0.28678050583952669 0.23575311384103462 0.24556419782928124 0.11513452719190442 0.78251323986382992 0.95770541076047622 0.89031144935726048 1.0802008064175501 1.6248484592075436 1.897059945783653 1.5337656260169099 1.1493581038008835 1.4947423455874413 0.82410260327682694 1.1562941169378345 0.76403747818464862 1.0478766810197546 1.3478929878191921 1.0454906398097814 0.61115327122490748 0.61570902624168089 0.50066023730563736 -0.096375147642338163 -0.42898169514270645 -0.94582920805000248 -0.72834368734536881 -1.0659180809610957 -1.3433413579131608;-2.6040980033125547 -2.6247596370958961 -2.5333529225086471 -2.9060498036928535 -2.8193521170591116 -2.9837927276484284 -2.6918189575761744 -2.7409573493347663 -2.9777169418801392 -2.6919920307643901 -2.750880999310227 -2.804847760183272 -2.5558990958542092 -2.1833305820203108 -2.9771399255691078 -2.6213886737691943 -2.9117742118333685 -2.3054417518358132 -2.621613831628149 -2.9928967636127655 -2.7603316176753299 -2.2486278183067423 -2.2834267783785966 -2.6724392271011559 -2.2937993657472222 -2.796887853013275 -2.807524227980482 -2.7102648136673073 -2.8345015050324496 -2.4718285400004163 -2.6146582071696569 -2.5194770341920245 -2.3634132435209172 -2.6012201834736879 -2.3723504247883653 -2.3021302872797711 -2.327795036034825 -2.865110315496441 -2.5067510295337572 -2.6811318328412135 -2.7337002398099131 -2.2540499444025657 -2.7362759225236744 -2.4397971613337086 -2.5137337136926559 -2.6436641043284457 -2.786437045274071 -2.9859297740616464 -2.8673153108853766 -2.6748704757393664;2.7519733426966893 2.6301157787478453 2.3687776058289192 2.7911967967272147 2.7023708367467121 2.9895516211495941 3.0755165498924595 2.9071265705195901 3.0778845350876729 2.5682149351832213 2.7951139386690258 2.4371612207563302 2.660322573995439 2.8783115101869772 2.7415970165695094 2.9435734526744408 2.9374786514577829 2.6227459806604969 2.7139038667082942 2.9874585352669007 2.4977334701751692 2.9382171056019142 2.324498766941669 2.3467742013722375 2.6864538042636372 2.7513908978780175 2.9952813478090308 2.9300168048723689 2.7100568036069825 2.25788533387 2.4081752571106936 2.6538965539861579 2.9137192868809465 2.7981415927484208 2.8339358045999146 2.8328816407282176 2.3209010402197556 2.2962635094805717 2.5408420778663787 2.4929549325109455 2.6905039092550656 2.9423498336640166 2.8594608904339069 3.0116195823529663 2.7564711087134004 2.9238338839522364 3.0700820351648517 3.1098928492602886 2.8826818202267077 2.9061610981787025;4.4421454287065867 4.3305076191861485 4.1405383628319221 3.4497551056153677 3.1257166104662968 2.8435045879008305 2.3557803517390057 2.2568320836670148 1.7031491593146972 1.8762617080948232 1.5306693503875235 1.1459513556926373 0.42993589720888586 0.0051272092894850269 0.12395435632308778 -0.21561897128018409 0.013899253630063915 -0.71948203669224298 -1.0371182342442453 -0.3593559581599679 -0.60088018122544262 -0.19041993412138122 -0.34981104244089645 0.10459607525704928 -0.060303594280419225 -0.033774103752396256 -0.5245232555234699 -1.8100719495194375 -3.5823194858530814 -6.0870182786858678 -7.5828373851898512 -7.6359951954511525 -7.133726664536379 -6.1353516385345559 -5.5630476268861608 -4.3890002230207603 -3.6174143658924689 -3.4489345178933655 -3.084796590912239 -3.6317647802257582 -3.6759650924945673 -2.3628327420097244 -1.2905141788737231 0.57829664090636956 2.4382455955217992 4.6828161637020491 6.4376942864446711 8.1792116576730827 10.150910090276767 10.988735698058552;-11.955229498829436 -10.915615893321471 -9.8711274136313492 -8.8674250623595441 -7.5016098307237256 -6.4906862825794311 -5.3154313571595191 -4.250826341915019 -3.2097195687591893 -2.304295534057037 -1.4348508215340459 -0.51618845487973697 0.76382919900173674 1.384846743155389 1.5154200155509685 2.3760536684442952 3.2324408785227274 3.59426721643251 3.8205166303434486 4.0448919198948854 3.6501168361134768 3.3623937380233428 2.8598046016212355 2.5535676231080036 1.7962355457116794 1.129647606874324 2.4156244749852527 6.3240428063277436 12.546417566422488 19.464539326648691 24.061361357986002 24.788055129566537 22.921128017346675 20.803134277896099 18.011716208536331 15.257880138898237 13.226628222724159 12.336300012095844 12.394698703555573 12.479476224616432 11.837721355172745 9.5313504502778681 5.9791985696121053 0.75180796387227111 -4.5402498048528823 -10.13724318396922 -16.250990490676045 -21.128113339955313 -26.0196363685981 -29.880610508597133;3.2335308812393473 3.2483799014418846 2.9951342868971191 2.451092074007061 2.303914681539494 2.2023832973491522 1.603945010342593 1.2938975778860269 1.1469635785454846 0.8530809089764877 0.26754182594140996 0.5517963310418007 -0.059764244501111223 -0.22428508797917135 -0.64918933288126635 -0.65586945639094418 -0.86544341346755294 -0.81721411514132214 -0.67756824470751398 -1.2470700671992232 -0.67515641602127119 -0.60135517874779254 -0.80038809537545874 -0.83682095591409722 -0.18545384984672569 -0.15473092771477029 -0.32994426375958935 -1.9491386071182979 -3.7886643451285122 -5.7118867141968108 -6.4211406231016532 -6.3516048903990727 -6.5363755925108382 -5.3104962835833609 -4.7627238565355654 -3.7621304751718272 -2.9196860494037886 -2.5689125637566068 -2.5574715531900289 -2.8922778109112781 -2.8260700914226908 -1.8103258869731471 -0.92399623207778925 0.28055730755665914 2.0575104924393108 3.3720811812419131 5.4623302421141364 6.5091614201928616 7.9447433733935204 9.1864949053609326;-0.23643127473252942 -0.58404521040341351 -0.26487693344390617 -0.085464933029553464 -0.39073920518796534 -0.39428489295530639 -0.0063479837327322817 0.0044307857825429285 -0.3261004739463737 -0.31724515128210184 -0.34108430195630507 0.16312485658744824 -0.28360648133267835 0.036816541049046747 -0.34345622980871215 -0.40565635287280638 -0.23622831249170295 0.0019439001466759222 -0.089928507147386497 -0.046690367847705368 -0.42497995366357272 -0.4961866599405661 -0.044016150041932926 0.13860487220843604 0.14780782090346431 -0.024586835013510281 0.18215356243608158 0.18923738349591965 -0.24541641270687684 -0.10730384825047067 -0.099861892361930452 0.13279064115811043 0.072114835178686457 -0.25057979164291633 -0.27748053198049816 0.23435081597359178 0.22099569728169705 -0.42645214877841592 -0.12393720025696316 -0.34216237644427755 0.16426732086207932 -0.0037267661530308725 0.15289849537038389 -0.48425637245734465 -0.10169654545082848 -0.3393913820663631 -0.41816268002857959 -0.44625815560073945 -0.58746790646166691 -0.58121479437996437;0.35851484484594143 -0.069992917551316924 0.3728126454078623 0.015742244260479515 0.31324384004336209 0.29523382258898889 0.33973630987553288 0.29555482294290231 0.14486088750112133 -0.080567736820949476 0.30834130545907767 0.10580599850552108 0.11137218677148521 0.024972608753689216 0.30920184471173012 0.18847263897516733 0.12329281458056447 0.29854214421438174 0.40199801654849504 0.30691318700131914 0.3989558515454204 -0.20980181387790162 -0.051047565872666421 0.10568711922781705 -0.26074349801039209 0.11178833191125051 0.14721887020013663 -0.24987552899706145 0.42723246073404209 0.036161796423953479 0.34206841344746514 0.29039482042384807 0.36856257746472099 0.3789053383014066 0.25398048173930871 0.22393960637145685 0.34839581982767143 0.1311997804071757 0.38471721541204751 -0.14715850001084921 0.17099524463531604 0.13539104846840019 0.18411440401434087 0.067858671875374574 0.27448195844121637 0.43355652462647432 0.180639812799958 -0.19992170337830176 -0.063516768444561444 0.42305105500659379;-1.6389863712959187 -1.0775655845263967 -1.2370134345197727 -1.3982334460432371 -1.5128466884639433 -1.337357474479395 -1.5131090612148475 -0.95166980536833889 -1.0866245152028298 -1.3959166858476995 -0.99034697988720422 -0.9407684350897354 -1.5289064697282415 -1.3546888074817296 -1.3008659254855228 -1.2369172406371209 -1.0823300504072191 -1.4848629002842866 -1.4964323413584542 -0.95790061810224603 -1.5485368776814925 -1.5322903880639767 -1.1521851796429965 -1.3982314756866459 -1.4430013629967151 -1.0580132775690385 -1.1278741209121532 -1.4732839353608937 -1.3804765852351115 -0.79100387115788118 -1.2950760403533659 -1.2068599050452578 -1.3783545306461591 -1.0900019256204636 -1.2140120622403441 -0.9917245169426584 -0.88415932815306109 -1.0838470062850147 -1.0981249432678766 -1.135494557176786 -1.4408372713996844 -1.1341134188235613 -1.4254054861322381 -0.93214859797987382 -1.3937098818147038 -1.024335189121903 -1.4575834160426844 -1.166641146110982 -1.4367126667270895 -1.1347490383898065;-0.36520804487391351 -0.060618454063726304 -0.22367101766235109 -0.27747278386911578 0.1322997901084306 -0.35791429052815205 -0.36839512028299365 -0.18842120086956654 -0.3371574453271734 0.27417179216411819 -0.26446108357546594 -0.064943115787195915 -0.070974183688362114 -0.44517005128621973 -0.18153488312620861 -0.14534016907178887 -0.15660339502151482 -0.04175883855155995 -0.16491801280375554 -0.21936859740965944 0.14006736032221409 -0.22733122229438887 -0.34459898571572362 -0.16458062497164933 0.16318612947131414 -0.31351506146611247 -0.19081549788782357 0.029694163667311032 -0.24958882303323593 -0.33607858766079363 0.25507505489684518 -0.39084997402350091 -0.11079580384105059 -0.19056051379024128 0.21026520920267219 0.27855677196906015 -0.32292615813334646 -0.3748925825105775 -0.15570469065582551 -0.094389499139580307 -0.17535267801790008 -0.0064165460492420102 0.21458819254657868 -0.19545668043196954 0.25195177578497058 -0.28775488553526768 0.00038733722024154296 -0.48840402090575419 -0.42756225197309111 -0.44470326073667271;3.6853936517728845 3.3044239054757591 3.5069379160247474 3.2238870801692903 3.0906373309602744 3.0712418998046789 3.2982457885816583 3.6511803893257522 3.2567386263536093 3.4961131711459101 3.2916150410485252 3.7862685547199115 3.4645841044564261 3.4616720402421155 3.1227418464609049 3.3559444068062394 3.0173369037804085 3.566797893393935 3.2312919860226628 3.3367085547420463 3.3981749840734148 3.268018074202522 3.3143965753207061 2.9810293714565126 3.3881841531243211 3.1341164112977853 3.0098124632411993 3.4382582274815912 2.8857763659814508 3.220517251511632 3.2592221266778254 3.4654649135554014 2.9708475179084965 2.9572350302393593 3.1910203818406639 3.638830411743716 3.2120812580757971 3.3158816117542367 3.6592990084149615 2.9155782242915342 3.0386155365185843 3.3929824136017217 3.6894960960857817 3.2878406433115721 3.4398235465308349 3.6154356180356175 3.6642833408492006 3.395057073362775 3.5332836887244627 3.6410240392470254;9.2553607605251411 7.9930083217092127 7.7945402961496333 6.9148113475081612 5.7311809483180074 5.1780858774861453 4.5857413982441644 3.5573969957625304 3.0069216228545157 2.3743081351951969 1.2477555767689803 0.57784314046204832 -0.24111233928066964 -0.60120920189440996 -1.5122410094927965 -1.4686698635803235 -1.7982904975200662 -2.4308821886801111 -2.7704991476227234 -2.4322762233234627 -2.7671195435600344 -2.6836943063253784 -2.2619236702760643 -1.2991522612356363 -1.0024660334491475 -0.65015629227330618 -1.4614021070477821 -4.0286960990531595 -9.5107559521103902 -14.139539417864853 -17.496500801611237 -18.236385966443031 -17.210653247484782 -15.345931802024582 -13.847924424956695 -11.27268765451783 -10.042345952563958 -9.5045909200028511 -9.3529162225235254 -9.4026129580976576 -9.0476281520050161 -7.8460854721987063 -4.5314838569939857 -0.92945947893043002 3.077758877544035 7.7223903675382974 11.928629421410287 15.8616901312813 18.90752369006233 22.344998961186125;-12.698853712723809 -11.385732154814917 -10.778475177718489 -9.1710514214002004 -8.8492392490347545 -7.6314519331658595 -6.9577763985700534 -5.5364142140289045 -5.0922547805780862 -3.4766010912101812 -2.9226977267840728 -1.4758904227981999 -0.85642910426498176 0.27681461134371865 0.36190460949116504 0.59951188482219508 1.638725899272629 2.1367654440292161 2.5022758439736803 2.285380205803353 2.4227147840206147 2.2954871790034126 1.4315741783515403 1.2476568593459194 0.32392042493224799 -0.23708899976626019 1.2906961853086496 4.2595373696971972 10.516818995863074 17.02851139978829 21.412562753333443 22.101157463046743 20.450063531769686 18.737661092808899 16.307867401415507 13.67402294975729 11.912317035932043 11.057431137839798 11.050517588887264 11.27216952033913 11.183857652845221 8.4257738854478692 5.1791697935781071 -0.057357432393827228 -5.5164911374479315 -10.747976849942381 -16.036795670763151 -21.043452253127096 -25.620595954203772 -29.146680069011872;-2.2995627707285689 -2.7991422147376199 -2.6256692414385481 -2.7048210998485613 -2.4312432888708848 -2.6261532480107248 -2.4286402221567998 -2.5378286763155793 -2.9777851078336366 -2.5836394309980322 -2.1962551739828071 -2.676301193374345 -2.5634027164433006 -2.658071009039388 -2.8421815060467988 -2.6529126077892573 -2.2829100979394434 -2.4993001933335806 -2.5656579653043763 -2.1458213720460808 -2.4920025764682769 -2.2399063911564521 -2.6204193581057402 -2.6736238477404428 -2.7709959132273179 -2.482548459801702 -2.5025307225110813 -2.426149780192457 -2.7082401603613873 -2.5715310262200717 -2.713874937553336 -2.4503896900072735 -2.5548875844969592 -2.5956449080592283 -2.4724211874776221 -2.5030364951571302 -2.1228812765016425 -2.7105811928183203 -2.8379340334881009 -2.3125359524110913 -2.8132793494156036 -2.708636217839866 -2.9028295254814744 -2.7363181283921452 -2.8713682394448172 -2.563418852496095 -3.0418680660308 -2.5301221117133643 -2.9094616738825025 -3.1399551354459954;22.579225990832178 19.884013935815414 17.604849415461143 15.797245832374031 14.341233260370297 12.626373180202261 10.462944362169596 8.6556738958438686 7.0399323263477322 4.7019699804470001 2.5717128131160516 1.0234884724948816 -0.96002584126252399 -2.1301043716712069 -3.2921417566533813 -4.0131003072101219 -5.5314710311960473 -6.4858669692277253 -7.2269924276105311 -6.9924272147322171 -6.7901217223383972 -6.5124906281877326 -4.8900142844001486 -4.3483926135469844 -2.6282692605916598 -2.63928217311748 -4.1191664375037629 -11.236156709460042 -23.115641815648001 -35.847279709435789 -43.949619781662662 -45.124245655242106 -41.975626902331584 -38.183709210986429 -32.926776776284079 -28.590433666678237 -24.275128516768007 -22.504898655874953 -22.617537833458655 -23.079676456920669 -22.423199444860924 -17.794137876598075 -10.790966420863704 -1.1762269175049587 9.530409007253942 20.277868272100825 30.302909701640839 40.28285931891471 48.678521981745774 56.811513338365835;18.5721582081575 16.24797730958619 14.964485266330795 13.554511348396069 11.567840125142647 10.367623061861039 8.6808293918207671 7.3596441373592718 5.9693152115021544 4.0189061029695203 2.4429707622587506 0.50526176561714986 -0.65894847267672296 -2.1011622281062339 -2.6901906674480176 -3.1691141351689147 -4.3918066126350679 -5.4079000404352673 -5.7730306238346687 -6.0578909072883622 -5.5399688899589252 -4.7973491506579897 -3.9044264090693961 -3.5069328945115967 -2.5918904414492205 -1.9229183800723368 -3.5155602394900454 -9.3945419951117053 -18.635133657460965 -29.132455892904407 -35.843327776852128 -36.890113624860469 -35.048490285307082 -31.514308954838597 -27.280574433290248 -23.069648240083314 -19.72155383733822 -18.283823163968606 -17.887284863749819 -18.331650218119741 -17.583933845315471 -14.5746775019034 -7.8649792888705736 -0.4197995012336434 8.3961549494237655 16.74644306394551 25.433398125716725 33.196522858158147 40.794892628111548 46.624114736871057;15.170600152672161 13.708718486303074 12.930795200550691 11.547784727104917 10.611965751519641 9.0561981953424038 8.5138544190934837 7.363784176482298 5.8224440953110861 4.5015523823486436 3.4505541389964742 1.9409700665395306 0.95548467296212192 0.6045215398063305 -0.25409446133759006 -0.68028068831091149 -2.0453870898696276 -2.1804598017844983 -2.8807217118884707 -3.0616841786300517 -2.6817821296292133 -2.4001708810000864 -1.4711624528260012 -0.91754283095223688 -0.54661336051563569 -0.029539481943990843 -0.95991601151314532 -5.7071650699180445 -12.413621693493788 -20.224260955092262 -24.632864411944094 -25.603588601751827 -24.430028095973022 -21.791558865096061 -19.02439320550835 -16.015305635203148 -14.113270555526938 -12.638557802013818 -12.604834994066261 -12.82298219255909 -12.365603734906596 -10.128225342221636 -5.4240708068748784 0.5801859457489128 6.2602722379256237 12.929890757874496 18.834212609394687 24.686486174772551 30.20420220631469 35.07861786185498;2.8181999699235538 3.1004975393335679 2.1826964892640466 2.1774802671990607 1.7697813496259214 1.5546345310213709 1.5778270385191719 1.2144224147870091 0.70153638027444554 0.99935987523747039 0.37043708748048382 0.35081841644623107 -0.3415052474515739 0.23423770308432157 -0.64070928829085361 -0.46997062664484451 -0.3158462625434868 -0.34204908620372043 -0.74565259542569273 -1.1129317960224026 -0.96846010915142189 -0.45010672458692974 -0.76817624769344761 -0.18321319135409339 -0.18293312638406115 -0.056118023183198189 -0.60001331050929663 -1.2913198286121816 -2.7592528094128341 -5.0285220925975915 -5.6148165277282098 -5.6524060093098845 -5.8370125533691555 -4.9968172382775791 -4.1051265576511007 -3.6026889638163704 -3.0414333151026507 -2.4952587842231782 -2.7055925403022876 -2.6542286478741293 -2.5642410593668559 -2.0947664164068605 -1.1141898881818331 0.036370538857977495 1.7050464783095745 3.0844433490520839 4.3912979286073615 6.0641856783164307 7.0719048208658499 8.1805775211738094;-9.1474147726261545 -8.1508113833795459 -7.8711624278265795 -6.8813818185470152 -5.752470652974651 -5.2036982313707716 -4.2331524532449887 -4.0419319485402028 -2.6784997332014981 -2.0662692149733459 -1.0819766484611106 -0.46485650611413243 0.28121131505182945 1.052061554159393 1.2962461816791566 1.7631719836240818 1.8012447865891885 2.7174353342651929 3.0646385358124459 3.0419112916710738 2.8358888653496921 2.2520792143025772 2.2393720585757984 1.3464590059579289 0.84263761976657925 1.1104771408583962 1.8476828489534893 4.3110925749068603 9.3292735288133954 15.135687349162408 18.076102049222527 18.836539892174972 17.59800069868308 16.028186986561799 13.286543362528803 11.82347054680741 9.6187180618418573 9.1585542283221439 9.1354043144252355 8.9477354463927554 9.2277699826837143 6.771710616085918 3.8602405557426573 0.12321930207782703 -4.2784874717382406 -8.9945662084564031 -13.456843807448495 -17.102322688345758 -20.911651764266033 -24.082982852461068;-10.327532358266149 -8.8994955808465406 -7.5341934314918175 -7.132847091025587 -5.9707500917037999 -5.134968264674538 -4.2798208473982999 -3.5162495452642988 -2.5844995660956744 -1.9813865596849893 -0.76893404557464984 -0.036674131811880631 0.67587515035558754 1.6747539074330446 2.4122672148990052 2.7465590198176346 2.9659894423009772 3.2698409528285484 4.1882060761373072 4.1820614365966966 4.0085094312808254 3.4831429101632354 3.255256453733538 2.3839326142977453 1.5791447148314897 1.594630158603678 2.5629018880243239 5.7788538425056943 11.599958460228644 17.757688301052269 20.848158544406214 21.430390814384015 20.397728756612182 18.067653066608507 15.766083616719586 12.985072647413354 11.485667087680016 10.403556085618701 10.09821782939577 10.49021340899033 9.9868434877701802 8.1364587934041719 4.5111205552018649 0.07067643862896128 -5.1060068820593338 -9.8345349355465537 -14.443818774949005 -19.415610197312795 -23.513589525791197 -27.601084504140164;2.7473857936455985 2.567995041993723 2.7149185232667845 2.7434124031665679 2.4670970994254118 2.7525443270393004 2.6817769523343413 2.3666428194887459 2.6476547601621254 2.6170238490904061 2.6600225461137366 2.7816981467694379 2.6836837225667312 2.6333467907072592 2.2829875471808401 2.5177556986029606 2.4007247280726891 2.5602197344294257 2.4612514586021437 2.4814805691980504 2.7150510145791746 2.1083237723305834 2.2071863213961627 2.2933939379628505 2.178150846221881 2.6198176468404002 2.5437604840171244 1.9423528787228976 1.7900606372415424 1.7941666459409689 1.6583496519047158 1.4601801535471943 1.3424293702839303 1.8464317294274353 1.4552959646439547 1.7448671418724866 2.0291003625280126 2.2681202186162199 2.4192775347758908 1.9889646011763211 2.2589251794457388 2.4514349874389247 1.9001358700805251 2.0814391802971581 2.6995800870521296 2.8344712772021685 3.2148742684777996 2.9508886044366087 3.1852425104669888 3.3733181824727163;1.6115036161151777 1.7243914859377218 1.5708373413840995 1.434750511126035 1.4293721571270337 1.1160067759861669 1.3425201638661464 1.2255310609925139 1.2498578093728789 1.612497264551439 1.218284515550899 1.4358485664934912 1.2665808882016485 1.4204055345711029 1.5394344910863393 1.5331887160957332 1.0422666145320141 1.5506243984677266 1.6833346790574495 1.6818152106795208 1.677119186517537 1.0186607045180678 1.5677118823484342 1.3165959107889702 1.0930932592603024 1.0170845223856277 1.3267044683595364 1.6772002527887793 1.2627935113029827 1.4132306987508794 1.5430431130266373 1.4225845836582971 1.343584268898659 1.0742072064606198 1.2269099109403327 1.4835712977798523 1.1464336057950322 1.011531314022442 1.2910171927349137 1.4843480640873106 1.1105422586875642 1.098997373359935 1.3932793812155864 1.550661620549826 1.6956777308127402 1.1790231561017974 1.4735902874767062 1.6479641785802219 1.7873460566014785 1.221180699922269;8.5813923104690666 8.1002600569131236 7.0453454338370962 6.1402563736869622 5.9858494875488795 5.31503419921762 3.9891501593578567 3.7873151790997439 2.5197892516387443 2.1360532368381322 1.3505266879219509 0.27829078845657884 -0.36194126984999359 -0.80360248402530643 -1.2366344650599752 -1.129260502782101 -1.8446489549709673 -1.8708380674796179 -2.6750847301058047 -2.2705609831862321 -2.179585671027199 -2.3226696558133089 -1.787683751472255 -1.5220179173283999 -1.2101487440196164 -0.52504646399509125 -1.359231891540152 -3.8501800627126226 -8.4680418720230914 -13.530999480550072 -16.558078918237705 -16.48251025140506 -15.588430845162781 -14.321953734099273 -12.294564573838819 -10.420353362562436 -9.4259281304775229 -8.327147219972197 -8.2592939714754863 -8.9931653743784974 -8.7030045024154354 -6.5528761552659915 -4.0057983325224846 -0.26144941048605375 3.4000329758244052 7.2585710404009056 11.162068713815989 14.678746951975779 17.937433083281356 21.350611020369318;7.5448780773712372 6.7112462436050748 6.0173794543755408 5.6053950692086163 4.4871998411995797 3.9350614134535635 3.9432321351679271 2.6796738382431928 2.2162133310561627 1.8853899327064301 0.5101027520101441 0.1751545158128904 -0.57196402693447712 -1.3435736253207855 -1.3269333060255732 -2.0030546268540537 -2.3138193235907312 -2.4639760351872733 -2.7465850026678909 -2.4707603308297008 -2.5870157687371598 -2.2993986163204116 -2.2610313416463352 -1.6977625878233149 -0.90083344977097324 -0.9108795593400083 -1.769836712136124 -4.0475825442698028 -8.3948916200160717 -13.41111348915593 -15.92633366405485 -16.319027817226356 -15.649751425071331 -14.321029858251057 -12.484697518104324 -10.732982437083296 -8.794842707303852 -8.5110260824522825 -7.8754868456385818 -8.3466869152141996 -8.1790354463367407 -6.4292722027705524 -4.0233855646570289 -0.12140848055588997 3.2334348284271197 7.4278988844862823 10.940374158750691 14.460008349673735 17.483817053736928 20.556412423073276;2.2932647741820036 2.415140171657332 2.3148099287968731 2.1979024683301973 1.9576947801112332 2.5718381667868018 2.1527140870647856 2.248532492718339 2.4887807002666724 2.4688054727895006 2.3983152258878775 2.3257861240948663 2.6147182340836452 2.3396025677943575 2.546181786840267 1.838835040485032 2.5790526904464572 2.0805650404156029 1.9523568309500436 2.2549250971180501 2.174074451656729 2.5143700738311856 2.084857336604292 2.5083694649606998 1.8170236899944445 2.4736390123935346 2.3900521044243241 2.6045840638582116 2.1954417290534884 2.3261009778798258 2.3003727624654209 1.7315993284802309 2.365991256701145 2.0942877033240084 2.3397315380456614 2.1656271043018656 2.1302906470353857 2.2717614358616811 2.0009759012379087 2.0698739351488076 2.0726467554802626 2.3450434477777824 2.224580996930118 2.6306027406932473 2.5362608356544158 2.3105319242829943 2.5428897917876538 2.2041261510089574 2.3032191147432153 2.3949435716642866;-3.8908067277304426 -10.375322987908381 -15.737670482281148 -20.890789130245416 -25.699200245333135 -29.74013098870903 -32.760575074805942 -34.80592550564441 -35.903712016680508 -34.509834007792314 -30.604371788886841 -24.345578724614562 -17.839786749514147 -11.084515237722652 -6.7937663834468154 -3.573645469096181 -1.6705204557810047 -0.54603789850901918 0.72001017551400237 3.0649552744153747 8.3512662195371572 17.366670832110209 30.557509145166112 45.246153904799918 68.241277564195656 80.468881353653018 60.511913348569358 45.902115429970948 46.164551433515634 46.982485881967122 44.166491665080393 38.9097925163532 31.933381269065663 23.837988509250145 14.008204005119365 4.9907514478607791 -0.97643998544398569 -3.7263549034443892 -2.9366984842007695 1.3000467928964992 7.2707410125789345 12.459292820508255 14.858394239278045 14.606185154538938 10.435881727583137 -0.082473889811408754 -13.489648349951045 -27.093831222900278 -37.834919409680317 -43.788977316536844;2.1213938859085335 1.9850681940581367 2.2849933826596076 1.8714444370732535 1.7589283599854204 1.9752848438388795 2.0057583801666228 2.0503693085455019 1.5773233366331294 1.8609599008165292 1.5899994723590054 1.8532716158959814 1.5458486163440608 2.0092627629829609 1.6005309576426539 1.6182895196333291 1.91427141574481 1.8809207405949868 1.265855093763079 1.380951605111076 1.2872449370877372 1.4237465122935211 1.5822056621018747 1.6171105406949706 1.4908063169260688 2.0352369939186663 1.3368289751172282 1.2146521310153522 1.5214099761619351 1.0336347246492439 0.87998440351695628 0.89671145567243582 0.8968023051318339 1.2299629767934934 1.5044467441053366 1.3618305749944066 1.7361229092795327 1.5415264180943793 1.756789913577925 1.6410598220203889 1.302934254491787 1.3070616904165733 1.2737447166415583 1.7320493728220936 1.9341063546825983 1.698301171257973 2.0575795539903057 2.2714187924808522 2.176633142852916 2.0879629090891578;-3.1482436457524221 -3.3607986695153844 -3.2995087704970105 -2.8702635133637711 -3.1209981789518353 -3.0313656879441919 -2.6944884595466649 -3.2586076528422234 -2.7063538517076755 -2.8506363539990724 -2.8206993243207097 -2.695406606021078 -3.3204618592677333 -3.2846831948601327 -2.6723955355059572 -2.8550333851823231 -3.0039700546109525 -2.55535902751441 -2.7127154547099699 -3.08350166067597 -2.8259153932392942 -2.9332997684010045 -2.590143576102756 -2.6904089747004858 -3.0660195785334365 -2.5324848347210627 -2.6224807607655429 -2.9058326042480904 -2.7539015066401369 -2.5741295183478901 -2.2481088190751213 -2.4723014148427875 -2.5196493633958559 -2.5572653106007621 -2.557927075353744 -2.8841490565340147 -3.0673956664907309 -2.5128422218933109 -2.506703418055221 -2.9674023522991679 -2.5824571825363623 -3.0253621619977027 -2.6604901937550927 -3.133953266725281 -3.0047212846474172 -3.2110067883961619 -2.9413237811101873 -3.4454983057940582 -3.0867342223113119 -3.3680802448040952;-2.0786055709252542 -1.6508716625998883 -2.0049566631430329 -1.806550334440614 -2.0006293661884755 -2.101902360245969 -1.9428923624079852 -1.5759705689008383 -1.4932354160691255 -1.9503083990901358 -1.9924489229054934 -1.5069234673957768 -1.4112352143444897 -2.0118228075351499 -1.9467124386112054 -2.1126347629315059 -1.6570006175448335 -2.092643756479251 -1.5817082242327674 -1.9992707970370029 -1.9224867304128845 -1.6594244571698844 -1.8540836157561489 -1.8807354905009976 -1.5654982204451307 -1.8740676430308947 -1.8324122413856512 -1.9120956803727704 -1.371326922395931 -1.7827891885044853 -1.6781355841395051 -1.6463437318364065 -1.8343222592400477 -1.7065625932627331 -1.9345808941581657 -1.6485843183750724 -2.079257199696841 -1.4716063270862156 -1.9467159518689652 -1.3780801713079858 -1.8544921181601186 -1.6897662162781999 -1.8818609280354166 -1.9569765006000854 -2.1337266982408614 -1.5413811138272551 -2.1115084915557913 -1.9812756983744766 -1.6750789363992491 -2.1919867049554891;9.7639242959407699 8.9678143758872402 7.8081395422822473 7.6250479266407174 6.3991000794605952 5.9876159070948161 5.6471112666504846 5.0458795862991348 3.8335786435515873 3.5545502871215096 3.0478257410305027 2.2370473644947104 1.1246932102549914 1.256189705406366 0.44310878529656866 0.15029139964398519 -0.3754784016080181 -0.58245948268914616 -1.0214109885186897 -1.0873381279898904 -0.88143622565572777 -0.49386352788167182 -0.25591316825646243 -0.071581545363026605 0.46733814040823862 0.46739943508623844 -0.13445570702275808 -2.0662822191464154 -6.2316128430625897 -10.241994668202723 -13.137045303642912 -13.41184637827676 -13.266515979827481 -11.493279765499857 -10.024783942354677 -8.5432368218476284 -7.3144209687752104 -6.5176709214952977 -6.8351891765436577 -7.1178543847265123 -6.683455069723764 -5.3169172264188029 -2.5468466056458428 0.15258931881185531 4.0253100118760354 7.5776242998457457 10.666661596052609 13.9788664317167 17.448043084385553 19.622390980742566;2.1974388687432258 2.6282014264716316 2.2345146744042799 2.2494051527164345 2.275579817917412 2.6884320191274611 2.7779532311240986 2.6373184363410012 2.2651164290514489 2.3451177719233574 2.660809787352532 2.1475567308843129 2.4793315471521695 2.6381866025494922 2.6401095266086294 2.3305702728793256 2.4260972802969771 2.4237618494759801 2.4372396929251847 2.7268497862880174 2.5507387269300947 2.5601834664037462 2.3989248407404449 2.6581691355530919 2.5714516667340823 2.2904758420980582 2.1743311222349169 2.3503350032620434 2.6256793652482431 1.919740928025242 1.9024222998841809 1.8735852770841546 2.3210980591771442 2.5119491532222669 2.1845298360628655 2.5498690041771832 2.2725471182092503 2.3867165180816778 2.0599123250400302 2.4788870559380327 2.6194880391492346 2.615751923550802 2.6286484453766894 2.3301489839732845 2.362770481316355 2.8269139855789351 2.7366764091983455 2.3523259743102307 2.822761179499214 2.9969546449342488;-19.785079782183633 -18.222152983294276 -16.496533102156864 -14.354252602227245 -13.58640424051884 -11.821777068424042 -10.386728760557284 -8.4397418468170695 -6.8734865260694891 -4.9914228609648106 -3.1712070584444363 -1.3307151591941278 -0.4634319635455536 0.50868773425050062 1.8332308077155701 2.6260596347688763 3.819546988199026 4.09850168199885 5.1638436874439133 5.2854088725782393 4.9138309300723266 4.0261086415567817 3.1497902154306439 2.4512842041672744 1.426193783004398 1.1267131263517072 2.9024678992513233 8.6771073923338662 18.159792249044152 29.218551188188169 35.622655850419399 37.267765090876559 35.052054353765797 31.164953145255705 26.985603708628354 23.194230475086091 19.976743887606798 17.897705395000575 17.773592220007451 18.60181186781065 17.569887654172877 13.94621082351183 7.7490591382171532 0.020362634947249138 -8.9488507078195152 -17.725391716526087 -26.628056540269753 -34.803025030922399 -42.101781080831508 -48.482248909675597;-2.9750870567044951 -3.104435909292115 -3.0217922658990526 -3.2073500459715976 -2.6095511009188885 -2.9444749374995651 -2.5851534466480457 -2.787391676908376 -2.9769385603353031 -2.4529481577980858 -3.0499605802157466 -3.1952966669996439 -2.7063938500095079 -3.1873774881303918 -2.9992564994132604 -2.7293414020557019 -2.5241333957806589 -2.957483928383561 -2.4958523834624189 -2.7672813674485672 -2.5808834780474976 -2.6682715104830113 -2.8616889661125078 -2.6437956498517394 -2.9754757222216495 -3.0076879809763413 -2.7789343706844005 -2.4126349230114039 -2.6793253756465827 -2.6227026846955952 -2.7616350827550034 -2.7389057753166757 -2.5054360158001283 -2.9079114617625361 -2.4116868890909235 -2.723728726073916 -2.4767462044869752 -2.5549815064522301 -2.7601787006609562 -2.5332014572147004 -2.7785125354765068 -2.8029228350566222 -2.6396029203817943 -2.5461244117745632 -3.1565396236181495 -2.7259674655301227 -2.7846976912554458 -3.4659130708633645 -3.5776730826256884 -3.4627774378256793;-5.8183139205549974 -5.2202582341918005 -4.6589087366425908 -4.6894336718035303 -4.4166579892721041 -3.5513355345075563 -3.3765681243857069 -3.0755994165693599 -2.9506574393299743 -2.681070268405187 -1.9279269157844479 -1.3953433123892212 -1.447473395457668 -0.72703411420719932 -1.211562343511341 -0.66118003805577552 -0.15153812761793078 -0.56298417732563688 -0.29451327387884008 -0.4072291459126075 -0.19041138452162504 -0.18991005771567274 -0.45326022628068002 -0.82512130178607768 -0.89148820051340483 -0.66896118237823765 -0.78199016129046905 0.79783750921167196 2.940983700397314 4.970245934223084 6.3292415658896513 6.3555602995839244 6.144409421729228 5.754428254652268 4.5827748933216021 4.1422940692511974 3.1746693756060314 2.9219649211530974 2.4594466404229109 2.8507591975183746 2.7077933595267405 2.1725072093285451 0.41229930597248038 -0.70761254812149765 -2.5131133389787741 -4.9222849811614537 -6.1865196089497774 -8.0414604629767368 -9.9349785999380025 -10.793476668987561;3.1190274161876363 3.1942724424607585 3.0893441071477086 3.0313337417891617 2.7003947744861612 2.6409800109243653 2.9835894608659665 2.4658935455178872 2.4543484317674635 3.0890124529151892 2.9790349687252506 2.581876118520436 2.7810262668201089 2.806906222097842 2.4701604738951688 2.8047286945193228 2.8084480921104933 2.2879533752305603 2.891180490141676 2.2880444724517015 2.5702989927798634 2.326595510271062 2.5554313546289458 2.4399294781938452 2.7009564566540947 2.9716421761849228 2.4732973564798506 2.2604218442775168 2.3984936384764204 2.3842852529834788 2.2084930856015168 1.6945921921328264 2.3050753413074441 2.2595984784105942 2.2861480309860949 2.1175608833841677 2.0053421346242652 2.1209165249855615 2.073006014766658 2.1243250408728351 2.0675261731293091 2.0881113654931611 2.1443538674752629 2.4678635818005326 2.5276098885669174 2.6478747506888607 3.3336653619253576 3.106369612874746 3.3106866866206897 3.4305861363303203;-19.756243671101579 -17.605791788558133 -16.192183730201698 -14.240599276278727 -13.218633275692447 -11.705323243576883 -9.9868258239136249 -8.2173727465670243 -6.9933083927457371 -5.3559380871351081 -3.6384282971597033 -1.7727891012756483 -0.10578157105153164 1.0118130285988496 1.8076329759836132 2.2386402957347538 3.6689729824286093 4.6039257118702537 5.2732732511830482 5.3632906756040502 5.0788687359140194 4.4637784943963519 3.8002241840458715 2.2964574165222564 1.6975761066673187 1.293222320024086 3.022881817261601 8.3044002328292326 18.506160317655482 29.05048608472022 35.487396322877728 36.749274215936666 34.734500109268666 31.448012023635634 26.760066890842896 23.073622601279304 19.575239561114405 18.134855594965995 18.152101265618327 18.886940367997472 18.127963868450674 14.434587597597226 7.9990895522038397 0.3290003815252453 -8.7040816744882665 -17.670983794123504 -26.382713894865972 -34.578819298939344 -41.84714600925642 -48.112156167067717;0.74620741827099057 1.1894078921704998 0.77460398742580794 0.98335842460023859 0.93046745712574996 1.0147592879425882 0.69319873621083117 0.77422280160525692 0.77871675028473797 0.54810418168601849 0.5210691600036671 0.82881566219906466 0.70318518800415508 1.0472136528665901 0.85457472854194694 0.53109381908145181 0.89668062334928966 1.0778499039146179 0.48738478589038392 1.0571984224056161 1.0331088091339353 0.57418781668957275 0.64463416543990948 1.0219262729615164 0.67201073119953281 0.7690569887283506 0.71838554609467264 0.94801266910962811 0.97347269267570902 0.65802271909932053 1.0168848605402507 0.5278222150722961 0.83900570763744509 1.0935634860476178 0.51235801135097636 1.1326521342473328 0.95566188957404707 0.7048049576173282 0.40260333766316264 0.41601640924959149 0.83931681498089605 1.1753441051180413 0.89657354032234871 0.95641348382551405 1.0827901697452516 0.60662710192466385 0.72773212849251301 0.73694562470805092 1.133834927434378 1.0205734835431282;3.5003492831119836 3.1614357309784014 3.2442020664496409 3.2456121722651901 2.7231221549541695 2.3809483758356551 2.721881156013755 2.1927488989158697 2.2203844674185054 1.5913329275150128 1.8535229344667354 1.593715608587138 1.4456227093022684 1.0198078842298353 1.1498141380636568 0.89921365378036233 0.82584105092674442 0.88918653986709129 0.5746316087847998 0.51322639345960597 1.1362146209535395 1.2299104586606473 1.1442851207511358 1.1886784931139123 1.0087921611719688 1.5215676774097722 1.3235523558417892 0.3377576015799561 -0.50290028210192894 -1.5521706417829897 -2.2055861061695565 -2.6671795424393947 -2.6927953233232049 -2.2242166552995219 -2.0463445030394229 -1.6258471598140785 -1.2026066388618981 -1.1144877239391218 -0.49957768208646641 -0.75433192245878566 -0.46682446869209726 -0.57990379721250396 -0.070848666723219905 0.74916964029574451 2.0244834954241662 2.7962919620893425 3.8757511462041658 4.5361135591031152 5.6627504788760366 6.3042652478517391;21.928158283979926 20.256854297786962 17.740348981065228 16.286271322401507 14.516351037385846 13.369777315156092 11.308012943231498 9.4659880529451463 7.6044822887909582 5.9130286957884586 4.4315309152284144 2.2308992825913019 0.83548106133201139 -0.34232637846320163 -1.6230153011269928 -2.1631926333539568 -3.6565824638718851 -4.4055734593296076 -5.1441573724236545 -5.3831063958956804 -4.5005225028316085 -4.2405450661096191 -3.4746170672333005 -2.5721864429365544 -1.3886807991895171 -0.35410169013804232 -2.6798668715268832 -9.1570863907483346 -19.70207662793576 -31.533033241260746 -38.275697395612433 -39.915618702053813 -37.553885334741054 -33.200716060598097 -28.684862296138167 -24.743959450141634 -21.192976851717731 -18.927108677082238 -18.994817846890133 -19.978563289960224 -18.971837032956969 -15.276450428744694 -8.0316553775927879 0.6174583602008572 10.221978591921038 19.406370335313124 29.220828362176711 37.757193387884818 45.950240294764122 53.066388699750348;4.1778505775803385 3.993860359312146 3.5713522079736522 3.575935728577738 3.8179838660485719 3.9242774177590203 3.3630323594788711 3.2869400557466606 3.2747648953305655 3.5353812424357556 3.336636531719003 3.3177172193951878 3.3538216196511677 3.0028394670309431 3.1389528283413526 3.5003291569455248 3.5447346859367821 2.9191810460727714 3.1494987137637915 3.2573951868692799 3.4789229674160169 2.988830305479222 3.164288273479912 3.0876766805615641 3.4189696199075983 3.577872645435515 3.2380787381326686 3.3095036751296023 2.9618961576549072 2.8171755580542777 2.3631055304077924 2.4584991852855578 2.3234706858630645 2.7707289201848906 2.4092448298086331 2.7241355125670235 2.6920639465805953 2.6081818113170492 2.610356441709377 3.0472638101600293 2.9704039747861777 2.7720563193839847 3.3435430887113711 3.07845114634544 3.8921863639477685 4.1898159602144478 3.8264999618013698 4.6601965407257255 4.8974463553879382 5.0608128085872881;0.51702517775490942 0.74012825102843993 0.82202337645188184 1.018425521859567 0.58164617201512303 0.94499335672627682 0.7121115443877386 0.64792322636736288 0.89451175128477423 0.98096090780479739 0.36148115461129943 0.33735290667933959 0.67804091944690326 0.94656324285971638 0.67259209122143715 0.65308003117161717 0.34123079543425811 0.81765723202976859 0.69548540077366161 0.2694579362046205 0.67786624455855826 0.74087233896894666 0.75742062743981797 0.34805232678886272 0.4236147211762703 0.88349829099005739 0.45174039789544557 0.30321168745557814 0.24020172721951555 0.13576040770925762 0.56696529103977744 0.70024881357442315 0.63469614430466881 0.67373505977702552 0.31368578822090581 0.27026947698830212 0.81587562321242335 0.33078122830414031 0.6484323354995446 0.66967580306129604 0.78844816284357511 0.23773663003522427 0.67167876932493609 0.71567635339668678 0.81396604107185733 0.53409794821450463 0.75460771654990577 0.87129577883591791 1.270807716760423 1.1852376423074635;-1.8305866792477365 -1.0962951055889243 -1.6497091744103127 -0.97644586988176496 -1.3846747140672824 -1.4454551938672073 -1.145892321211077 -0.73507002639307084 -0.76275886907877066 -1.1580564910356101 -0.79156163010331215 -0.5082635980231871 -0.17139892357176975 -0.58058932529840945 -0.71083271334705334 -0.34653735127293861 -0.3612760131122642 -0.38441970843564277 0.059656822241810098 -0.4013701308711054 -0.18714205376939322 -0.57172133307070649 -0.30698050499040069 -0.29063663151752811 -0.36316901154149195 -0.56939193145486144 -0.74001752409515276 0.16939005495991843 0.69077290998656671 1.1220714172902901 1.3962973177970339 1.5148713670015053 1.4926544565687825 0.88690853956186932 0.7650287121897098 0.82668316989128188 0.6908517023957238 0.37770900374611788 0.74717352550870364 0.18355940095834286 0.61298448385185123 0.3870731174508189 -0.14721867711989464 -0.39841202455712876 -1.2686458669885348 -1.558952945319779 -1.7592815333654237 -2.0166407910692246 -2.5566742122708668 -2.6330831827163808;1.0274076477495004 0.56343685910186703 1.1876801875460485 1.20480844618214 0.63952365925700549 1.0436227741373725 0.66317086823220406 0.84437438693885192 0.48099132698588981 0.58569015212870035 0.51814045427397604 0.8724426463204199 0.80798939032818506 0.44530970690563965 0.82410870774656331 0.44397091822196655 0.7366188435634301 0.46413844078202238 0.60034954276495878 0.88699983866732468 0.78715980473923575 0.78163092717354177 1.006663445341863 0.80069506812318914 0.47691417335625147 0.83443413117074261 0.63660906265715855 0.75366896491447366 0.9586828354579664 0.63639754023174988 0.51501146326511105 0.79473588056028222 0.97929013142662646 0.34818470087046488 0.55395780829175845 0.42786784720723953 1.0453975705329577 0.54750093178514136 0.73787861754197226 0.39033139469944139 0.80145266289489292 1.0637535768993458 1.0266820293799535 0.67572117541424814 1.1092946097867777 0.8744381765857091 1.0270169105839173 1.0917308072354426 0.90117423828475163 1.2979513330189847;20.87635894124946 19.882218748138278 19.348120641624362 19.209425364366382 18.507198808320492 17.616219843895028 17.400345921779348 16.297889178708818 15.668488439223124 15.039540483580227 14.339553960464819 13.936903531790442 12.790644974699337 12.743859060097105 12.537610073548997 12.290718073800832 11.903433431804567 11.028144683390186 10.855253354784535 11.382343642729941 11.39102502850589 11.424324344276114 11.74010787215539 11.784271423042206 12.386485189356858 12.747177847845458 12.359478344371704 9.821595556750637 5.5130354446383425 1.3282418099311684 -1.5448491257261434 -1.4132257574997489 -0.99299138667230646 0.92834179592631738 2.5418328645977124 3.8467342273208556 5.342719138183841 5.6453648881928604 6.1529311130628805 5.298288520281293 5.8797112371882241 7.585509299615584 9.7065317102283579 12.739252909342014 16.628522966701563 20.286531439624845 23.6513662998806 27.101351345822259 29.654876374135458 32.588259791541454];
b2  = [11.838442899929138;-12.854220643381547];
LW2 = [91.96789091348198 13.166420674034569 -11.026377135752639 10.102322130733645 -8.0625635060298819 -134.1689070814065 -8.4562395443174516 10.378096986654265 -11.842190451836871 0.45883784602718919 110.1866505515208 0.95909990549534518 6.1473027316438724 -13.013696418875588 1.8331236693355162 10.390177527172217 -11.173346980633976 -85.643883093277836 36.882390400239935 10.864758055272658 -134.71515932977942 -105.93143702272528 -32.683437413003055 -10.042724543153399 46.26816467952888 44.244010852115231 -15.793522483267672 -12.825972202469508 -62.309485451622066 -74.397546299740711 -12.157070518231919 181.78815379392509 -10.205867986189823 -3.9037170659027298 12.041922695814987 -14.019566808895799 -10.392505141541239 128.96696869085969 9.8275438259111656 4.6175835300908936 5.0242705295685397 137.22861212641192 -7.5138025402631134 1.9430918378798105 -169.63604395109687 4.4352400450691452 -8.4078586478554573 -1.3774500015734334 9.1108859421438844 -150.81517781922653;-93.152596685101983 -13.267676139699292 11.372334745232406 -8.9925999272816473 9.0059241219348003 132.44232926216608 8.2655628176596725 -9.1498625204466464 11.671695817845638 -0.10626457135758868 -110.71898849268023 -1.7209633454560724 -6.3661977869586446 13.160467169835183 -1.6420468925706462 -11.579248480790337 11.372232125075724 84.060915241919901 -37.270458636590853 -9.4434809569109159 133.98465516884417 106.29913189389467 33.25264141740594 11.183904352666172 -47.373550039870864 -44.331305043187342 16.860227827374889 12.824224796087377 60.982467606378457 73.540765754338537 11.452943100226214 -182.75109030648815 10.867575527585279 3.3114259874954568 -12.564649617454528 14.291378934316198 11.222630753180898 -128.93254688408081 -8.6941888220082255 -4.2435232744059013 -4.7558808082333499 -138.08841101988287 6.5539652052491686 -2.0739869637984185 168.4206716629752 -4.2991897983604792 7.5533663078870754 2.5496527689596551 -7.9049080231799334 152.15806103334924];

Q = size(yInput, 2);

xp = mapminmax_apply(yInput, inputStep);

a1 = tansig_apply(repmat(b1, 1, Q)  + IW1 * xp);
a2 = softmax_apply(repmat(b2, 1, Q) + LW2 * a1);

yOutput = mapminmax_reverse(a2, outputStep)';

end

function a = softmax_apply(n)

nmax = max(n, [], 1);
n = bsxfun(@minus, n, nmax);

numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;

a = bsxfun(@rdivide, numerator, denominator);

end

function a = tansig_apply(n)

a = 2 ./ (1 + exp(-2 * n)) - 1;

end

function y = mapminmax_apply(x, settings)

y = bsxfun(@minus, x, settings.xoffset);
y = bsxfun(@times, y, settings.gain);
y = bsxfun(@plus,  y, settings.ymin);

end

function x = mapminmax_reverse(y,settings)

x = bsxfun(@minus,   y, settings.ymin);
x = bsxfun(@rdivide, x, settings.gain);
x = bsxfun(@plus,    x, settings.xoffset);

end